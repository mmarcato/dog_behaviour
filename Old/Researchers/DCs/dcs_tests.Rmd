

## Within Subject Analysis

result = wilcox.test(dcs[dcs$Data.Collection.Number == 1 , "Isolation.Response..Time.oriented."],  dcs[dcs$Data.Collection.Number == 2, "Isolation.Response..Time.oriented."], paired = TRUE)
class(result[["statistic"]])

```{r, include = TRUE}
## SUMMARY STATISTICS

for (var in na.omit(vars[vars$Test == "Wilcoxon", "Variable"])){
  print(var)
  print(aggregate(var ~ Data.Collection.Number, data = dcs, summary))
}    

for (var in na.omit(vars[vars$Test == "Wilcoxon", "Variable"])){
  print(str(var))
  print(wilcox.test(dcs[dcs$Data.Collection.Number == 1 , var],  dcs[dcs$Data.Collection.Number == 2, var], paired = TRUE)[1:3])
}


for (var in na.omit(vars[vars$Test == "Wilcoxon", "Variable"])){

  print(str(var))
  print(wilcox.test(dcs[dcs$Data.Collection.Number == 1 , var],  dcs[dcs$Data.Collection.Number == 2, var], paired = TRUE)[1:3])
}



```
### Ordinal data
Running Wilcoxon for ordinal data. 
```{r, include = TRUE}
# groups are the dcs
ordinal_within_groups <- function(df){
  result = c()
  for (variable in ordinal){
      r = wilcox.test(df[df$Data.Collection.Number == 1 , variable], df[df$Data.Collection.Number == 2, variable], paired = TRUE)
      result = rbind(result, c(variable, r[1], r[2], r[3]))
  }
  return (result)
}

dcs_ordinal = ordinal_within_groups(dcs)
ordinal_sign = dcs_ordinal[dcs_ordinal[,4]<0.05, ]
print(ordinal_sign)
```

### Count data
Running wilcoxon for count data. No signficant results found.
```{r, include = TRUE}
# groups are the dcs
count_within_groups <- function(df){
  result = c()
  for (variable in count){
      r = wilcox.test(df[df$Data.Collection.Number == 1 , variable], df[df$Data.Collection.Number == 2, variable], paired = TRUE)
      result = rbind(result, c(variable, r[1], r[2], r[3]))
  }
  return (result)
}
dcs_count = count_within_groups(dcs)
count_sign = dcs_count[dcs_count[,4]<0.05, ]
```

### Categorical data
run chi-squared for categorical data

```{r, include = TRUE}
# groups are the dcs
categorical_within_groups <- function(df){
  result = c()
  for (variable in categorical){
    if (length(unique(df[df$Data.Collection.Number == 1 ,variable]))>1 & length(unique(df[df$Data.Collection.Number == 2 ,variable]))>1){
      #`correct=FALSE` to turn off Yatesâ€™ continuity correction.? 
      r = chisq.test(df[df$Data.Collection.Number == 1 , variable], df[df$Data.Collection.Number == 2, variable])
      result = rbind(result, c(variable, r[1], r[2], r[3]))
    }
  }
  return (result)
}
dcs_categorical = categorical_within_groups(dcs)
categorical_sign = dcs_categorical[dcs_categorical[,4]<0.05, ]
print(unlist(categorical_sign[,1]))
```
